<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Quiz</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{ --bg1:#000000; --bg2:#062a5f; --bg3:#2f2f33; --bg4:#dcdde1; --accent1:#00aaff; --accent2:#00ffcc; --glass: rgba(255,255,255,0.06); }
html,body{ height:100%; margin:0; font-family:'Poppins',sans-serif; background: linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3),var(--bg4)); background-size:400% 400%; animation:gradientMove 18s ease infinite; color:#ffffff; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; overflow:hidden; }
@keyframes gradientMove{ 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
.wrap{ min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px; box-sizing:border-box; position:relative; z-index:2; }
.card{ width:100%; max-width:760px; background:var(--glass); border-radius:18px; padding:32px; box-sizing:border-box; backdrop-filter:blur(10px) saturate(120%); box-shadow:0 8px 30px rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.02); text-align:center; position:relative; }
h1{ margin:0 0 8px 0; font-size:32px; letter-spacing:0.4px; }
h3{ margin:0 0 18px 0; font-weight:500; color:#dfe6f0; font-size:15px; }
.muted{ color:#d0d6e0; font-size:14px; margin-top:6px; }
.btn{ display:inline-block; background:linear-gradient(180deg, rgba(0,170,255,0.18), rgba(0,170,255,0.08)); border:1px solid rgba(0,170,255,0.3); color:#fff; padding:12px 22px; border-radius:12px; cursor:pointer; margin:8px; font-size:15px; transition:transform .18s ease, box-shadow .18s ease; position:relative; overflow:hidden; }
.btn:hover{ transform:translateY(-4px); box-shadow:0 8px 30px rgba(0,170,255,0.12); }
.btn:active{ transform:translateY(-1px) scale(.99); }
.btn-small{ padding:8px 12px; font-size:14px; border-radius:10px; }
.hidden{ display:none; }
.answers{ margin-top:14px; display:flex; flex-wrap:wrap; justify-content:center; gap:10px; }
.answer-btn{ min-width:180px; max-width:calc(50% - 20px); background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.04); color:#fff; padding:10px 14px; border-radius:12px; cursor:pointer; transition:all .22s ease; font-size:14px; }
.answer-btn:hover{ transform:translateY(-4px); box-shadow:0 10px 30px rgba(0,0,0,0.45); }
.answer-btn:disabled{ opacity:0.7; cursor:default; transform:none; }
.progress{ height:14px; background:rgba(255,255,255,0.04); border-radius:999px; overflow:hidden; margin:18px 0 8px; }
.progress .fill{ height:100%; width:0%; background:linear-gradient(90deg,var(--accent1),var(--accent2)); transition:width .5s ease; }
.meta{ font-size:14px; margin-top:8px; color:#dbe8ff; }
.particles{ position:fixed; inset:0; z-index:1; pointer-events:none; }
.p{ position:absolute; border-radius:999px; opacity:.9; filter:blur(6px); mix-blend-mode:screen; }
.transition{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:6; background:rgba(0,6,30,0.7); color:#fff; font-size:22px; opacity:0; pointer-events:none; transition:opacity .45s ease; }
.transition.show{ opacity:1; pointer-events:auto; }
@media (max-width:640px){ .answer-btn{ min-width:100%; max-width:100%; } .card{ padding:22px; } }
</style>
</head>
<body>
<div class="particles" id="particles"></div>
<div class="wrap">
<div class="card" id="startScreen">
<h1>Quiz</h1>
<h3>Criado por AndrÃ©, Pedro, Ian e Gabriel â€” 9Âº Ano B</h3>
<p class="muted">Escolha um tema inicial. Depois de cada tema, o prÃ³ximo comeÃ§a automaticamente atÃ© completar todos os 3 (30 perguntas).</p>
<div style="margin-top:18px;">
<button class="btn" onclick="startGame()">ComeÃ§ar</button>
</div>
</div>

<div class="card hidden" id="themeScreen">
<h1>Escolha um tema inicial</h1>
<div style="margin-top:14px;">
<button class="btn" onclick="selectTheme('Rito')">Rito</button>
<button class="btn" onclick="selectTheme('Mito')">Mito</button>
<button class="btn" onclick="selectTheme('SÃ­mbolo')">SÃ­mbolo</button>
</div>
</div>

<div class="card hidden" id="quizScreen" aria-live="polite">
<h1 id="themeTitle">Tema</h1>
<p id="questionText" style="font-size:18px; margin-top:6px;">Pergunta</p>
<div class="answers" id="answersWrap"></div>
<div class="progress" aria-hidden="true">
<div class="fill" id="progressFill"></div>
</div>
<div class="meta" id="metaInfo">Pergunta x de 10</div>
<div style="margin-top:14px;">
<button class="btn btn-small hidden" id="nextBtn" onclick="nextQuestion()">PrÃ³xima</button>
</div>
</div>
</div>

<div style="position:fixed; right:18px; bottom:18px; z-index:8;">
<div style="background:rgba(0,0,0,0.45); padding:10px 12px; border-radius:12px; backdrop-filter:blur(6px); box-shadow:0 8px 30px rgba(0,0,0,0.6);">
<button class="btn btn-small" onclick="toggleMusic()" id="playBtn">ðŸ”Š</button>
<input type="range" id="vol" min="0" max="1" step="0.01" value="0.28" onchange="setVolume(this.value)" style="vertical-align:middle; width:120px; margin-left:8px;">
</div>
</div>

<div class="transition" id="transitionOverlay">âœ¨ Mudando para o prÃ³ximo tema...</div>

<audio id="bgAudio" loop>
<source src="https://cdn.pixabay.com/download/audio/2021/10/11/audio_7f4b4b3c6c.mp3?filename=lofi-study-ambient-11285.mp3" type="audio/mpeg">
</audio>
<audio id="sfxCorrect" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="sfxWrong" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
<audio id="sfxClick" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>

<script>
// ====================== Helpers ======================
function shuffleArray(a){
    const arr = a.slice();
    for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]] = [arr[j],arr[i]];
    }
    return arr;
}

// ====================== Particles ======================
const particlesEl = document.getElementById('particles');
(function createParticles(){
    const colors = ['rgba(0,170,255,0.08)','rgba(0,255,204,0.06)','rgba(255,255,255,0.04)'];
    const count = 28;
    const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
    for(let i=0;i<count;i++){
        const p = document.createElement('div');
        p.className='p';
        const size=Math.random()*40+10;
        p.style.width=size+'px';
        p.style.height=size+'px';
        p.style.left=(Math.random()*100)+'vw';
        p.style.top=(Math.random()*110)+'vh';
        p.style.background=colors[i%colors.length];
        p.style.opacity=(Math.random()*0.6+0.08).toString();
        p.style.transform='translate3d(0,0,0)';
        particlesEl.appendChild(p);
        (function drift(elem){
            const dur=12000+Math.random()*16000;
            const toY=-(vw*(0.3+Math.random()*1.8));
            elem.animate([{transform:'translateY(0px)'},{transform:`translateY(${toY}px)`}],{duration:dur,iterations:Infinity});
        })(p);
    }
})();

// ====================== Quiz Data ======================
const quizData = {
"Rito":[
    {q:"Qual a principal funÃ§Ã£o social de um rito em sociedades tradicionais?", a:["Fortalecer a coesÃ£o e identidade do grupo","Entreter as pessoas","Organizar jogos","Registrar fatos histÃ³ricos"], correct:0},
    {q:"Ritos de passagem geralmente marcam:", a:["TransiÃ§Ãµes importantes na vida de um indivÃ­duo","O horÃ¡rio das atividades","MudanÃ§as climÃ¡ticas","Feriados nacionais"], correct:0},
    {q:"O que distingue um rito de uma simples rotina diÃ¡ria?", a:["O simbolismo e a intenÃ§Ã£o cultural","O tempo que leva para executar","A facilidade de ser repetido","O local onde ocorre"], correct:0},
    {q:"Ritos podem envolver elementos simbÃ³licos como:", a:["Gestos, palavras e objetos","Somente danÃ§as","Apenas alimentos","Exclusivamente oraÃ§Ãµes"], correct:0},
    {q:"Um rito pode reforÃ§ar normas sociais porque:", a:["ReforÃ§a valores e comportamentos esperados","Impede a liberdade","Confunde os participantes","Serve apenas para diversÃ£o"], correct:0},
    {q:"Ritos religiosos muitas vezes:", a:["Conectam o humano ao divino","Ensinar ciÃªncia","Organizar esportes","Marcar datas comerciais"], correct:0},
    {q:"O estudo de ritos no contexto histÃ³rico permite:", a:["Compreender a cultura e crenÃ§as de uma sociedade","Aprender matemÃ¡tica","Decifrar cÃ³digos secretos","Criar novas leis"], correct:0},
    {q:"Um exemplo de rito cÃ­vico Ã©:", a:["Homenagens em feriados nacionais","Lavar as mÃ£os","Fazer compras","Tomar banho"], correct:0},
    {q:"Por que ritos diferem entre culturas?", a:["Porque cada cultura atribui significados prÃ³prios","Por causa do clima","Por influÃªncia da economia","Devido Ã  geografia"], correct:0},
    {q:"O estudo de ritos pode revelar:", a:["Hierarquias sociais e valores Ã©ticos","Somente histÃ³rias antigas","Tecnologias antigas","Mapas geogrÃ¡ficos"], correct:0}
],
"Mito":[
    {q:"Qual Ã© a funÃ§Ã£o principal de um mito em sociedades antigas?", a:["Explicar fenÃ´menos naturais e humanos atravÃ©s de narrativas","Registrar leis","Ensinar matemÃ¡tica","Entreter sem significado"], correct:0},
    {q:"HerÃ³is mitolÃ³gicos geralmente simbolizam:", a:["Ideais, virtudes e desafios humanos","Sucesso financeiro","Fatos cientÃ­ficos","EstratÃ©gias polÃ­ticas"], correct:0},
    {q:"O mito do dilÃºvio em diferentes culturas simboliza:", a:["RenovaÃ§Ã£o, purificaÃ§Ã£o e recomeÃ§o","DestruiÃ§Ã£o sem propÃ³sito","Fome","MudanÃ§as climÃ¡ticas reais"], correct:0},
    {q:"Mitos frequentemente contÃªm elementos:", a:["Sobrenaturais e simbÃ³licos","Somente humanos comuns","Apenas animais","Tecnologias modernas"], correct:0},
    {q:"Os mitos ajudam a sociedade a:", a:["Transmitir valores e normas sociais","Calcular distÃ¢ncias","Organizar comÃ©rcio","Reduzir conflitos"], correct:0},
    {q:"A diferenÃ§a entre mito e histÃ³ria Ã© que o mito:", a:["Possui significado simbÃ³lico e nÃ£o precisa ser factual","Ã‰ sempre verdadeiro","Serve apenas para estudo","NÃ£o tem personagens"], correct:0},
    {q:"Mitos podem ser usados para:", a:["Explicar a origem de costumes e tradiÃ§Ãµes","Registrar inventos","Medir tempo","Escrever cÃ³digos"], correct:0},
    {q:"Os deuses em mitos representam:", a:["ForÃ§as e conceitos abstratos","Pessoas reais","Animais domÃ©sticos","Cidades antigas"], correct:0},
    {q:"O estudo comparado de mitos permite:", a:["Entender semelhanÃ§as e diferenÃ§as culturais","Aprender gramÃ¡tica","Decifrar cÃ³digos antigos","Resolver equaÃ§Ãµes"], correct:0},
    {q:"Um mito moderno pode ser considerado:", a:["Narrativa simbÃ³lica de valores contemporÃ¢neos","Fato cientÃ­fico","EstatÃ­stica histÃ³rica","Relato jornalÃ­stico"], correct:0}
],
"SÃ­mbolo":[
    {q:"Qual a funÃ§Ã£o de um sÃ­mbolo em contextos culturais?", a:["Representar ideias complexas de forma visual, sonora ou gestual","Marcar datas","Criar objetos","Medir tempo"], correct:0},
    {q:"SÃ­mbolos podem mudar de significado dependendo de:", a:["Cultura e contexto histÃ³rico","O tamanho do objeto","A cor do papel","A temperatura"], correct:0},
    {q:"O sÃ­mbolo da pomba representa:", a:["Paz e harmonia","Guerra","Trabalho","Sabedoria matemÃ¡tica"], correct:0},
    {q:"O estudo de sÃ­mbolos ajuda a entender:", a:["CrenÃ§as, valores e comunicaÃ§Ã£o nÃ£o verbal","Somente cores","Mapas","Fatos cientÃ­ficos"], correct:0},
    {q:"Um sÃ­mbolo pode ser:", a:["Objeto, gesto, palavra ou imagem","Somente cor","Somente palavra","Somente sinal de trÃ¢nsito"], correct:0},
    {q:"A cruz cristÃ£ simboliza:", a:["FÃ©, sacrifÃ­cio e salvaÃ§Ã£o","Vida selvagem","Sol e lua","Conquistas militares"], correct:0},
    {q:"SÃ­mbolos unem grupos sociais porque:", a:["Transmitindo significados compartilhados","Criam barreiras","SÃ£o sempre iguais","Substituem leis"], correct:0},
    {q:"As cores podem simbolizar:", a:["EmoÃ§Ãµes e conceitos abstratos","Apenas moda","Tipos de frutas","Estilos de escrita"], correct:0},
    {q:"SÃ­mbolos podem ser usados em rituais para:", a:["Comunicar intenÃ§Ãµes e valores","Organizar festas","Calcular tempo","Decifrar mensagens secretas"], correct:0},
    {q:"O estudo de sÃ­mbolos Ã© importante porque:", a:["Permite interpretar culturas e tradiÃ§Ãµes","Ensina matemÃ¡tica","Serve apenas para decorar","Substitui a linguagem"], correct:0}
]
};

// ====================== State ======================
let orderThemes = [], currentThemeIdx=0, currentTheme="", questionIndex=0;
let scoreThisTheme=0, totalScore=0, shuffledPerTheme={};

// UI refs
const startScreen = document.getElementById('startScreen');
const themeScreen = document.getElementById('themeScreen');
const quizScreen = document.getElementById('quizScreen');
const themeTitle = document.getElementById('themeTitle');
const questionText = document.getElementById('questionText');
const answersWrap = document.getElementById('answersWrap');
const progressFill = document.getElementById('progressFill');
const metaInfo = document.getElementById('metaInfo');
const nextBtn = document.getElementById('nextBtn');
const transitionOverlay = document.getElementById('transitionOverlay');

// audio
const bgAudio = document.getElementById('bgAudio');
const sfxCorrect = document.getElementById('sfxCorrect');
const sfxWrong = document.getElementById('sfxWrong');
const sfxClick = document.getElementById('sfxClick');
document.getElementById('vol').value = 0.28; bgAudio.volume = 0.28;

// ====================== Flow ======================
function startGame(){ sfxClick.play().catch(()=>{}); startScreen.classList.add('hidden'); themeScreen.classList.remove('hidden'); }

function selectTheme(themeName){
    sfxClick.play().catch(()=>{});
    const base=["Rito","Mito","SÃ­mbolo"];
    const si=base.indexOf(themeName);
    orderThemes=base.slice(si).concat(base.slice(0,si));
    currentThemeIdx=0;
    totalScore=0;
    shuffledPerTheme={};
    for(const t of base){ shuffledPerTheme[t]=shuffleArray(quizData[t]); }
    themeScreen.classList.add('hidden');
    setTimeout(()=>{ quizScreen.classList.remove('hidden'); startTheme(); }, 250);
}

function startTheme(){
    currentTheme=orderThemes[currentThemeIdx];
    questionIndex=0; scoreThisTheme=0;
    const arr = shuffledPerTheme[currentTheme].slice(0,10);
    shuffledPerTheme[currentTheme] = arr;
    renderQuestion();
}

function renderQuestion(){
    const q = shuffledPerTheme[currentTheme][questionIndex];
    themeTitle.textContent = currentTheme;
    questionText.textContent = q.q;
    answersWrap.innerHTML='';

    // shuffle answers
    const answersWithIndex = q.a.map((text,i)=>({text, originalIndex:i}));
    const shuffledAnswers = shuffleArray(answersWithIndex);
    const correctShuffledIndex = shuffledAnswers.findIndex(a=>a.originalIndex===q.correct);

    shuffledAnswers.forEach((a,i)=>{
        const btn = document.createElement('button');
        btn.className='answer-btn';
        btn.textContent = a.text;
        btn.onclick = ()=> selectAnswer(i, btn, correctShuffledIndex);
        answersWrap.appendChild(btn);
    });

    progressFill.style.width=`${(questionIndex/10)*100}%`;
    metaInfo.textContent=`Pergunta ${questionIndex+1} de 10 â€” Tema: ${currentTheme}`;
    nextBtn.classList.add('hidden');
}

function selectAnswer(index, btnEl, correctShuffledIndex){
    const btns = answersWrap.querySelectorAll('button');
    btns.forEach((b,i)=>{
        b.disabled=true;
        if(i===correctShuffledIndex){ b.style.background='linear-gradient(90deg, #00ff99, #88ffcc)'; b.style.color='#053'; }
        if(i===index && i!==correctShuffledIndex){ b.style.background='linear-gradient(90deg, #ff6b6b, #ff9b9b)'; b.style.color='#400'; }
    });
    if(index===correctShuffledIndex){ scoreThisTheme++; sfxCorrect.currentTime=0; sfxCorrect.play().catch(()=>{}); }
    else{ sfxWrong.currentTime=0; sfxWrong.play().catch(()=>{}); }
    sfxClick.currentTime=0; sfxClick.play().catch(()=>{});
    nextBtn.classList.remove('hidden');
}

function nextQuestion(){ sfxClick.currentTime=0; sfxClick.play().catch(()=>{}); questionIndex++; if(questionIndex<10) renderQuestion(); else finishTheme(); }

function finishTheme(){
    totalScore+=scoreThisTheme;
    currentThemeIdx++;
    if(currentThemeIdx<orderThemes.length){
        showTransition(`âœ¨ Mudando para: ${orderThemes[currentThemeIdx]}...`, ()=>{ startTheme(); });
    } else showResults();
}

function showTransition(text, callback){
    transitionOverlay.textContent=text;
    transitionOverlay.classList.add('show');
    setTimeout(()=>{ transitionOverlay.classList.remove('show'); setTimeout(()=>{ callback(); },350); },2200);
}

function showResults(){
    const totalQuestions = 30;
    let remark='';
    const pct=Math.round((totalScore/totalQuestions)*100);
    if(pct===100) remark='IncrÃ­vel â€” gÃªnio total! ðŸŒŸ';
    else if(pct>=80) remark='Excelente! Muito bem! ðŸŽ‰';
    else if(pct>=50) remark='Bom trabalho â€” pode melhorar! ðŸ’ª';
    else remark='Continue praticando â€” vocÃª consegue! âœ¨';

    quizScreen.innerHTML=`
        <h1>ðŸŽ‰ Quiz ConcluÃ­do</h1>
        <p style="font-size:18px; margin-top:6px;">VocÃª acertou <strong>${totalScore}</strong> de ${totalQuestions} perguntas.</p>
        <p class="muted" style="margin-top:8px;">${remark}</p>
        <div style="margin-top:16px;">
        <button class="btn" onclick="restartAll()">Jogar novamente</button>
        <button class="btn" onclick="backToStart()">Voltar ao inÃ­cio</button>
        </div>
        <p class="muted" style="margin-top:16px; font-size:13px;">Criadores: AndrÃ©, Pedro, Ian e Gabriel â€” 9Âº Ano B</p>
    `;
}

function backToStart(){ sfxClick.play().catch(()=>{}); quizScreen.classList.add('hidden'); themeScreen.classList.add('hidden'); startScreen.classList.remove('hidden'); }
function restartAll(){ sfxClick.play().catch(()=>{}); quizScreen.classList.add('hidden'); themeScreen.classList.remove('hidden'); shuffledPerTheme={}; orderThemes=[]; currentThemeIdx=0; questionIndex=0; scoreThisTheme=0; totalScore=0; }

function toggleMusic(){ if(bgAudio.paused){ bgAudio.play().catch(()=>{}); document.getElementById('playBtn').textContent='ðŸ”Š'; } else{ bgAudio.pause(); document.getElementById('playBtn').textContent='ðŸ”ˆ'; } }
function setVolume(v){ bgAudio.volume=Number(v); }
document.addEventListener('click',()=>{ if(bgAudio.paused) bgAudio.play().catch(()=>{}); },{once:true});
</script>
</body>
</html>
